<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>The lava and mets packages</title>
<!-- 2013-04-30 Tue 23:38 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.biostat.ku.dk/~kkho/styles/orgmode2.css"/>
<link rel="icon" type="image/x-icon" href="logo.ico"/>
<style type="text/css">body { background-image: url(logo.png); }</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012  Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">The lava and mets packages</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Multivariate Event Times (<code>mets</code>)</a>
<ul>
<li><a href="#sec-1-1">Installation</a></li>
<li><a href="#sec-1-2">Citation</a></li>
<li><a href="#sec-1-3">Examples</a></li>
</ul>
</li>
<li><a href="#sec-2">Latent Variable Models (<code>lava</code>)</a>
<ul>
<li><a href="#sec-2-1">Installation</a></li>
<li><a href="#sec-2-2">Citation</a></li>
<li><a href="#sec-2-3">Examples</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Multivariate Event Times (<code>mets</code>)</h2>
<div class="outline-text-2" id="text-1">
<p>
Implementation of various statistical models for multivariate event
history data. Including multivariate cumulative incidence models,
and bivariate random effects probit models (Liability models)
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">Installation</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">

<pre class="src src-R">install.packages(<span style="color: #259185;">"mets"</span>,dependencies=<span style="color: #a57705;">TRUE</span>)
</pre>
</div>

<p>
The development version may be installed directly from <a href="https://r-forge.r-project.org/projects/lava/">R-forge</a>
(requires <a href="http://cran.r-project.org/bin/windows/Rtools/">Rtools</a> on windows
and <a href="http://cran.r-project.org/bin/macosx/tools/">development tools</a> (+Xcode) for Mac OS X):
</p>
<div class="org-src-container">

<pre class="src src-R">install.packages(<span style="color: #259185;">"mets"</span>, repos=<span style="color: #259185;">"http://R-Forge.R-project.org"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">Citation</h3>
<div class="outline-text-3" id="text-1-2">
<p>
To cite that <code>mets</code> package please use the following reference
</p>

<pre class="example">
Thomas H. Scheike and Klaus K. Holst and Jacob B. Hjelmborg (2013). 
Estimating heritability for cause specific mortality based on twin studies.
Lifetime Data Analysis. http://dx.doi.org/10.1007/s10985-013-9244-x

BibTeX
@Article{
  title={Estimating heritability for cause specific mortality based on twin studies},
  author={Scheike, Thomas H. and Holst, Klaus K. and Hjelmborg, Jacob B.},
  year={2013},
  issn={1380-7870},
  journal={Lifetime Data Analysis},
  doi={10.1007/s10985-013-9244-x},
  url={http://dx.doi.org/10.1007/s10985-013-9244-x},
  publisher={Springer US},
  keywords={Cause specific hazards; Competing risks; Delayed entry; 
            Left truncation; Heritability; Survival analysis},
  pages={1-24},
  language={English}
}
</pre>


<div class="box1">
   <a id="box-link" href="https://r-forge.r-project.org/projects/lava/"></a>
</div>
<ul id="navigation">
<li><a href="https://r-forge.r-project.org/scm/?group_id=527">Source</a></li>
<li class="sub"><a href="#">Publications</a>
<ul class="org-ul">
<li><ol class="org-ol">
<li><a href="https://ifsv.sund.ku.dk/biostat/biostat_annualreport/images/a/ab/Research_Report_12-10.pdf">Estimating heritability for cause specific mortality based on twin studies</a>
</li>
<li><a href="http://arxiv.org/abs/1206.3421">Linear Latent Variable Models: The lava-package</a>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Examples</h3>
<div class="outline-text-3" id="text-1-3">
<div class="org-src-container">

<pre class="src src-R"><span style="color: #259185;">library</span>(mets)

data(prt) <span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Prostate data example (sim)</span>

<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Bivariate competing risk, concordance estimates</span>
p33 <span style="color: #259185;">&lt;-</span> bicomprisk(Hist(time,status)~strata(zyg)+id(id),
                  data=prt,cause=c(2,2),return.data=1,robust=1)

p33dz <span style="color: #259185;">&lt;-</span> p33$model$<span style="color: #259185;">"DZ"</span>$comp.risk
p33mz <span style="color: #259185;">&lt;-</span> p33$model$<span style="color: #259185;">"MZ"</span>$comp.risk

<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Probability weights based on Aalen's additive model </span>
prtw <span style="color: #259185;">&lt;-</span> ipw(Surv(time,status==0)~country, data=prt,
            cluster=<span style="color: #259185;">"id"</span>,weightname=<span style="color: #259185;">"w"</span>)


<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Marginal model (wrongly ignoring censorings)</span>
bpmz <span style="color: #259185;">&lt;-</span> biprobit(cancer~1 + cluster(id), 
                 data=subset(prt,zyg==<span style="color: #259185;">"MZ"</span>), eqmarg=<span style="color: #a57705;">TRUE</span>)

<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Extended liability model</span>
bpmzIPW <span style="color: #259185;">&lt;-</span> biprobit(cancer~1 + cluster(id), 
                    data=subset(prtw,zyg==<span style="color: #259185;">"MZ"</span>), 
                    weight=<span style="color: #259185;">"w"</span>)
smz <span style="color: #259185;">&lt;-</span> summary(bpmzIPW)

<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Concordance</span>
plot(p33mz,ylim=c(0,0.1))
abline(h=smz$prob[<span style="color: #259185;">"Concordance"</span>,],lwd=c(2,1,1),col=<span style="color: #259185;">"darkblue"</span>)
<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Wrong estimates:</span>
abline(h=summary(bpmz)$prob[<span style="color: #259185;">"Concordance"</span>,],lwd=c(2,1,1),col=<span style="color: #259185;">"lightgray"</span>)
</pre>
</div>


<div class="figure">
<p><img src="mets1.png"  alt="mets1.png"/></p>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Latent Variable Models (<code>lava</code>)</h2>
<div class="outline-text-2" id="text-2">
<p>
Estimation and simulation of latent variable models
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Installation</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">

<pre class="src src-R">install.packages(<span style="color: #259185;">"lava"</span>,dependencies=<span style="color: #a57705;">TRUE</span>)
<span style="color: #259185;">library</span>(<span style="color: #259185;">"lava"</span>)
demo(<span style="color: #259185;">"lava"</span>)
</pre>
</div>

<p>
For graphical capabilities the <code>Rgraphviz</code> package is needed
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #259185;">source</span>(<span style="color: #259185;">"http://bioconductor.org/biocLite.R"</span>);
biocLite(<span style="color: #259185;">"BiocUpgrade"</span>) <span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Upgrade previous bioconductor installation</span>
biocLite(<span style="color: #259185;">"Rgraphviz"</span>)
</pre>
</div>
<p>
or the <code>igraph</code> package
</p>
<div class="org-src-container">

<pre class="src src-R">install.packages(<span style="color: #259185;">"igraph"</span>,dependencies=<span style="color: #a57705;">TRUE</span>)
</pre>
</div>

<p>
The development version may be installed directly from <a href="https://r-forge.r-project.org/projects/lava/">R-forge</a>:
</p>
<div class="org-src-container">

<pre class="src src-R">install.packages(<span style="color: #259185;">"lava"</span>, repos=<span style="color: #259185;">"http://R-Forge.R-project.org"</span>)
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Citation</h3>
<div class="outline-text-3" id="text-2-2">
<p>
To cite that <code>lava</code> package please use the following reference
</p>


<pre class="example">
Klaus K. Holst and Esben Budtz-Joergensen (2012). 
Linear Latent Variable Models: The lava-package. 
Computational Statistics. http://dx.doi.org/10.1007/s00180-012-0344-y

BibTeX:
@Article{lava,
  title = {Linear Latent Variable Models: The lava-package},
  author = {Klaus K. Holst and Esben Budtz-Joergensen},
  year = {2012},
  journal = {Computational Statistics},
  note = {http://dx.doi.org/10.1007/s00180-012-0344-y},
}
</pre>
</div>
</div>
<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">Examples</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">

<pre class="src src-R"><span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Specify structurual equation models with two factors</span>
m <span style="color: #259185;">&lt;-</span> lvm()
regression(m) <span style="color: #259185;">&lt;-</span> c(y1,y2,y3) ~ eta1
regression(m) <span style="color: #259185;">&lt;-</span> c(z1,z2,z3) ~ eta2
latent(m) <span style="color: #259185;">&lt;-</span> ~eta1+eta2
regression(m) <span style="color: #259185;">&lt;-</span> eta2~eta1+x
regression(m) <span style="color: #259185;">&lt;-</span> eta1~x

labels(m) <span style="color: #259185;">&lt;-</span> c(eta1=expression(eta[1]),eta2=expression(eta[2]))
plot(m)
</pre>
</div>


<div class="figure">
<p><img src="lava1.png"  alt="lava1.png"/></p>
</div>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Simulation</span>
set.seed(1)
d <span style="color: #259185;">&lt;-</span> sim(m,100)
<span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Estimation</span>
e <span style="color: #259185;">&lt;-</span> estimate(m,d)
e
</pre>
</div>

<pre class="example">
                    Estimate Std. Error  Z-value   P-value
Measurements:                                             
   y2&lt;-eta1          0.95462    0.08115 11.76402    &lt;1e-12
   y3&lt;-eta1          0.98476    0.08956 10.99505    &lt;1e-12
    z2&lt;-eta2         0.97038    0.05390 18.00340    &lt;1e-12
    z3&lt;-eta2         0.95608    0.05666 16.87367    &lt;1e-12
Regressions:                                              
   eta1&lt;-x           1.24587    0.11541 10.79492    &lt;1e-12
    eta2&lt;-eta1       0.95607    0.18015  5.30712 1.114e-07
    eta2&lt;-x          1.11495    0.25263  4.41333 1.018e-05
Intercepts:                                               
   y2               -0.13896    0.12459 -1.11532    0.2647
   y3               -0.07661    0.13870 -0.55239    0.5807
   eta1              0.15801    0.12780  1.23644    0.2163
   z2               -0.00441    0.14858 -0.02969    0.9763
   z3               -0.15900    0.15731 -1.01076    0.3121
   eta2             -0.14143    0.18380 -0.76948    0.4416
Residual Variances:                                       
   y1                0.69684    0.14862  4.68885          
   y2                0.89804    0.16632  5.39933          
   y3                1.22456    0.21185  5.78037          
   eta1              0.93620    0.19636  4.76773          
   z1                1.41423    0.26262  5.38514          
   z2                0.87568    0.19466  4.49852          
   z3                1.18155    0.22643  5.21822          
   eta2              1.24430    0.29003  4.29032
</pre>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #465a61; font-style: italic;">## </span><span style="color: #465a61; font-style: italic;">Assessing goodness-of-fit (linearity between eta2 and eta1)</span>
<span style="color: #259185;">library</span>(gof)
g <span style="color: #259185;">&lt;-</span> cumres(e,eta2~eta1)
plot(g)
</pre>
</div>


<div class="figure">
<p><img src="gof1.png"  alt="gof1.png"/></p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2013-04-30 Tue 23:38</p>
<p class="xhtml-validation"></p>
</div>
</body>
</html>
